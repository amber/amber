<!doctype html>
<meta charset=utf-8>
<title>UI Demo</title>

<link rel=stylesheet href=static/demo.css>
<link rel=icon href=static/favicon.png>
<body>
<script src=markup.js></script>
<script src=src.js></script>
<script src=locale/en-US.js></script>

<script>

var a = Amber;

a.model('DemoUser', {

  data: {
    name: {},
    handle: {},
    about: {}
  }
});

a.view('DemoView', {

  template: 'demo-template',

  render: function(model) {
    ['name', 'handle', 'about'].forEach(function(key) {
      this[key] = a.view.DemoEditView(model, { key: key });
    }, this);
  }
});

a.view('DemoEditView', {

  template: '<span style="display: inline-block; white-space: pre-wrap; -webkit-user-modify: read-write-plaintext-only;"></span>',

  render: function(model) {
    model.on(this.key + 'Changed', this.contentChanged.bind(this));

    this.el.addEventListener('input', function() {
      model[this.key] = this.el.textContent;
    }.bind(this));
    this.contentChanged();
  },

  contentChanged: function() {
    var value = this.model[this.key];
    if (this.el.textContent !== value) {
      this.el.textContent = value;
    }
  }
});

var models = [
  a.model.DemoUser({
    name: "Nathan Dinsmore",
    handle: "nathan",
    about: "Nathan writes the Amber client."
  }),
  a.model.DemoUser({
    name: "Truman Kilen",
    handle: "MathWizz",
    about: "Truman writes the Amber server and puts up with Nathan."
  }),
  a.model.DemoUser({
    name: "Amber",
    handle: "amber",
    about: "The Github organization for Amber and related projects."
  })
];

models.forEach(function(m) {
  var view = a.view.DemoView(m);
  view.on('load', function() {
    document.body.appendChild(view.el);
  });
});

</script>
